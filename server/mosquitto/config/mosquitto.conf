# Eclipse Mosquitto Configuration for GPS Tracker
# MQTT Broker configuration file

# General settings
pid_file /var/run/mosquitto.pid
persistence true
persistence_location /mosquitto/data/
log_dest file /mosquitto/logs/mosquitto.log
log_type error
log_type warning
log_type notice
log_type information
connection_messages true
log_timestamp true
log_timestamp_format %Y-%m-%dT%H:%M:%S

# Network settings
listener 1883 0.0.0.0
protocol mqtt
max_connections 1000
max_inflight_messages 100
max_queued_messages 1000
message_size_limit 268435456

# WebSocket support
listener 9001 0.0.0.0
protocol websockets

# Security settings
allow_anonymous true
# Uncomment and configure for production:
# password_file /mosquitto/config/passwd
# acl_file /mosquitto/config/acl

# Client settings
client_id_prefix gps_tracker_
auto_id_prefix gps_tracker_
max_inflight_bytes 0
max_queued_bytes 0

# Persistence settings
autosave_interval 1800
autosave_on_changes false
persistent_client_expiration 1m

# Bridge settings (if needed)
# connection bridge-to-server
# address your-mqtt-broker.com:1883
# topic track/# out 1

# Memory and performance
max_keepalive 65535
retry_interval 20
max_inflight_messages 20

# Logging levels
# error, warning, notice, information, debug, websockets, none, all
log_type error
log_type warning
log_type notice
log_type information

# Topic patterns for GPS tracking
# Allow all topics for GPS tracking system
topic track/read
topic track/write
topic heartbeat/read
topic heartbeat/write
topic control/read
topic control/write

# Rate limiting
max_inflight_bytes 0
max_queued_bytes 0
max_inflight_messages 100
max_queued_messages 1000

# Clean session settings
clean_session true

# QoS settings
upgrade_outgoing_qos false

# Subscription settings
max_subscriptions_per_client 100

# Message retention
retained_persistence true

# Connection timeout
connection_messages true
log_timestamp true
